<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T-Engine - Debear Party</title>
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    <style>
        /* ========== ÂÖ®Â±ÄÊ†∑Âºè ========== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* ‰ºòÂåñÈ¢úËâ≤Á≥ªÁªü */
            --primary-gradient: linear-gradient(135deg, #00c4ef 0%, #e900e9 100%);
            --secondary-gradient: linear-gradient(135deg, #4dd0e1 0%, #d91e5a 100%);
            --neon-cyan: #00c4ef;
            --neon-pink: #e900e9;
            --neon-magenta: #d91e5a;
            --dark-bg: #0a0e1a;
            --dark-surface: #1a0a2e;
            --dark-purple: #2d1b4e;
            --text-primary: #ffffff;
            --text-secondary: #a0b1d4;
            --grid-color: rgba(0, 196, 239, 0.12);
            
            /* z-index Â±ÇÁ∫ß */
            --z-background: -1;
            --z-navbar: 100;
            --z-mobile-menu-overlay: 110;
            --z-mobile-menu: 120;
            --z-hamburger: 130;
            --z-toast: 200;
            --z-modal: 300;
            
            /* Èó¥Ë∑ùÁ≥ªÁªü */
            --spacing-xs: 8px;
            --spacing-sm: 16px;
            --spacing-md: 24px;
            --spacing-lg: 32px;
            --spacing-xl: 40px;
            --spacing-2xl: 48px;
        }

        body {
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Helvetica Neue', Arial, sans-serif;
            background: var(--dark-bg);
            color: var(--text-primary);
            overflow-x: hidden;
            line-height: 1.6;
        }

        /* ========== Á≤íÂ≠êËÉåÊôØ ========== */
        #particles-js {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: -1;
            background: 
                linear-gradient(90deg, var(--grid-color) 1px, transparent 1px),
                linear-gradient(var(--grid-color) 1px, transparent 1px),
                radial-gradient(ellipse at top, #2d1b4e 0%, #1a0a2e 50%, #0a0e1a 100%);
            background-size: 50px 50px, 50px 50px, 100% 100%;
            background-position: 0 0, 0 0, center center;
        }

        #particles-js::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: repeating-linear-gradient(
                0deg,
                rgba(0, 212, 255, 0.03) 0px,
                transparent 2px,
                transparent 4px
            );
            pointer-events: none;
            animation: scan 8s linear infinite;
        }

        @keyframes scan {
            0% { transform: translateY(0); }
            100% { transform: translateY(50px); }
        }

        /* ========== ÂØºËà™Ê†è ========== */
        .navbar {
            position: fixed;
            top: 0;
            width: 100%;
            z-index: var(--z-navbar);
            padding: var(--spacing-md) 5%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(10, 14, 26, 0.5);
            backdrop-filter: blur(20px);
            border-bottom: 2px solid rgba(0, 196, 239, 0.2);
            box-shadow: 0 4px 24px rgba(0, 196, 239, 0.06);
            transition: all 0.3s ease;
        }

        .logo {
            font-size: 28px;
            font-weight: 800;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            cursor: pointer;
            text-decoration: none;
            transition: transform 0.2s;
        }

        .logo:hover {
            transform: scale(1.05);
        }

        /* ÂØºËà™ËèúÂçï */
        .nav-menu {
            display: flex;
            gap: 40px;
            list-style: none;
            align-items: center;
        }

        .nav-menu a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s;
            position: relative;
            padding: 8px 0;
        }

        .nav-menu a:hover,
        .nav-menu a.active {
            color: var(--neon-cyan);
            text-shadow: 0 0 8px rgba(0, 196, 239, 0.6);
        }

        .nav-menu a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--primary-gradient);
            transition: width 0.3s;
        }

        .nav-menu a:hover::after,
        .nav-menu a.active::after {
            width: 100%;
        }

        .nav-buttons {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        /* ËØ≠Ë®ÄÂàáÊç¢Âô® */
        .lang-switcher {
            position: relative;
            margin-right: var(--spacing-sm);
        }
        
        .lang-btn {
            padding: 8px 16px;
            background: rgba(0, 196, 239, 0.1);
            border: 2px solid rgba(0, 196, 239, 0.3);
            border-radius: 20px;
            color: var(--neon-cyan);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
            min-width: 50px;
        }
        
        .lang-btn:hover {
            background: rgba(0, 196, 239, 0.2);
            border-color: var(--neon-cyan);
            box-shadow: 0 0 12px rgba(0, 196, 239, 0.4);
        }
        
        .lang-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 8px;
            background: rgba(10, 14, 26, 0.95);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(0, 196, 239, 0.3);
            border-radius: 12px;
            padding: 8px;
            min-width: 140px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s;
            z-index: 1000;
            box-shadow: 0 8px 24px rgba(0, 196, 239, 0.2);
        }
        
        .lang-switcher:hover .lang-dropdown {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        .lang-option {
            padding: 10px 12px;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s;
            color: var(--text-secondary);
            font-weight: 500;
        }
        
        .lang-option:hover {
            background: rgba(0, 196, 239, 0.15);
            color: var(--neon-cyan);
        }
        
        .lang-option.active {
            background: rgba(0, 196, 239, 0.1);
            color: var(--neon-cyan);
        }

        .nav-back, .mobile-back {
            padding: 10px 25px;
            background: transparent;
            border: 2px solid var(--neon-cyan);
            border-radius: 20px;
            color: var(--neon-cyan);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .nav-back:hover, .mobile-back:hover {
            background: var(--neon-cyan);
            color: white;
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.4);
        }

        .mobile-back {
            display: none;
            font-size: 20px;
        }

        .connect-btn {
            padding: 12px 30px;
            background: var(--primary-gradient);
            border: 2px solid transparent;
            border-radius: 25px;
            color: white;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 20px rgba(0, 212, 255, 0.5);
        }

        .connect-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 30px rgba(0, 212, 255, 0.7);
        }

        .hamburger {
            display: none;
            flex-direction: column;
            gap: 5px;
            cursor: pointer;
            padding: var(--spacing-xs);
            z-index: var(--z-hamburger);
        }

        .hamburger span {
            width: 25px;
            height: 3px;
            background: var(--primary-gradient);
            border-radius: 2px;
            transition: all 0.3s;
        }

        /* ========== ÁßªÂä®Á´ØËèúÂçï ========== */
        .mobile-menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            z-index: var(--z-mobile-menu-overlay);
        }

        .mobile-menu-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .mobile-menu {
            position: fixed;
            top: 0;
            right: -100%;
            width: 280px;
            height: 100vh;
            background: rgba(10, 14, 26, 0.98);
            backdrop-filter: blur(20px);
            border-left: 2px solid rgba(0, 196, 239, 0.3);
            box-shadow: -4px 0 24px rgba(0, 196, 239, 0.2);
            padding: var(--spacing-3xl) var(--spacing-lg) var(--spacing-lg);
            transition: right 0.4s ease;
            z-index: var(--z-mobile-menu);
            overflow-y: auto;
        }

        .mobile-menu.active {
            right: 0;
        }

        .mobile-nav-links {
            list-style: none;
        }

        .mobile-nav-links li {
            margin: 20px 0;
        }

        .mobile-nav-links a, .mobile-nav-links button {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 18px;
            font-weight: 600;
            display: block;
            padding: 12px 0;
            border-bottom: 1px solid rgba(0, 212, 255, 0.1);
            transition: all 0.3s;
            background: transparent;
            border: none;
            width: 100%;
            text-align: left;
            cursor: pointer;
        }

        .mobile-nav-links a:hover,
        .mobile-nav-links a.active,
        .mobile-nav-links button:hover {
            color: var(--neon-cyan);
            padding-left: 10px;
        }

        .mobile-connect-btn {
            width: 100%;
            margin-top: 30px;
        }

        /* ========== ‰∏ªÂÆπÂô® ========== */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 120px 5% 80px;
        }

        .page-title {
            text-align: center;
            margin-bottom: 60px;
        }

        .page-title h1 {
            font-size: 56px;
            font-weight: 900;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 20px;
            filter: drop-shadow(0 0 30px rgba(0, 212, 255, 0.4));
        }

        .page-title p {
            font-size: 20px;
            color: var(--text-secondary);
        }

        /* ========== ÈÄâÈ°πÂç° ========== */
        .tabs {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 50px;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 15px 40px;
            background: transparent;
            border: 2px solid rgba(0, 212, 255, 0.3);
            border-radius: 25px;
            color: var(--text-secondary);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tab-btn:hover {
            border-color: var(--neon-cyan);
            color: var(--neon-cyan);
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.3);
        }

        .tab-btn.active {
            background: var(--primary-gradient);
            border-color: transparent;
            color: white;
            box-shadow: 0 4px 30px rgba(0, 212, 255, 0.5);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ========== ‰ªãÁªçÂå∫Âüü ========== */
        .intro-section {
            max-width: 1000px;
            margin: 0 auto 60px;
        }

        .intro-card {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.08) 0%, rgba(255, 0, 255, 0.08) 100%);
            border: 2px solid rgba(0, 212, 255, 0.3);
            border-radius: 25px;
            padding: 40px;
            margin-bottom: 30px;
            transition: all 0.3s;
        }

        .intro-card:hover {
            border-color: var(--neon-pink);
            box-shadow: 0 20px 60px rgba(255, 0, 255, 0.3);
        }

        .intro-card h2 {
            font-size: 32px;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
        }

        .intro-card p {
            color: var(--text-secondary);
            line-height: 1.8;
            font-size: 16px;
            margin-bottom: 15px;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .feature-item {
            background: rgba(0, 212, 255, 0.05);
            border: 1px solid rgba(0, 212, 255, 0.2);
            border-radius: 15px;
            padding: 25px;
            transition: all 0.3s;
        }

        .feature-item:hover {
            background: rgba(0, 212, 255, 0.1);
            border-color: var(--neon-cyan);
            transform: translateY(-5px);
        }

        .feature-item .icon {
            font-size: 40px;
            margin-bottom: 15px;
        }

        .feature-item h3 {
            font-size: 20px;
            color: var(--neon-cyan);
            margin-bottom: 10px;
        }

        .feature-item p {
            color: var(--text-secondary);
            font-size: 14px;
        }

        /* ========== ÊåñÁüøÂå∫Âüü ========== */
        .mining-container {
            max-width: 900px;
            margin: 0 auto;
        }

        .mining-card {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.08) 0%, rgba(255, 0, 255, 0.08) 100%);
            border: 2px solid rgba(0, 212, 255, 0.3);
            border-radius: 25px;
            padding: 40px;
            margin-bottom: 30px;
        }

        .mining-card h3 {
            font-size: 28px;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 25px;
        }

        .alert {
            padding: 15px 20px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 25px;
        }

        .alert.info {
            background: rgba(0, 212, 255, 0.15);
            border: 2px solid rgba(0, 212, 255, 0.5);
            color: var(--neon-cyan);
        }

        .alert.success {
            background: rgba(0, 255, 136, 0.15);
            border: 2px solid rgba(0, 255, 136, 0.5);
            color: #00ff88;
        }

        .alert.error {
            background: rgba(255, 0, 100, 0.15);
            border: 2px solid rgba(255, 0, 100, 0.5);
            color: #ff0064;
        }

        .reward-box {
            background: var(--primary-gradient);
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            margin: 25px 0;
        }

        .reward-amount {
            font-size: 48px;
            font-weight: 900;
            margin: 10px 0;
        }

        .reward-label {
            font-size: 14px;
            opacity: 0.9;
        }

        .input-group {
            margin: 25px 0;
        }

        .input-group label {
            display: block;
            margin-bottom: 10px;
            color: var(--text-secondary);
            font-weight: 600;
        }

        .input-group input {
            width: 100%;
            padding: 15px;
            background: rgba(0, 212, 255, 0.05);
            border: 2px solid rgba(0, 212, 255, 0.3);
            border-radius: 12px;
            color: white;
            font-size: 16px;
            transition: all 0.3s;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--neon-cyan);
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.3);
        }

        .stat {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid rgba(0, 212, 255, 0.2);
        }

        .stat:last-child {
            border-bottom: none;
        }

        .stat-label {
            color: var(--text-secondary);
        }

        .stat-value {
            font-weight: 700;
            color: white;
        }

        .btn-primary {
            width: 100%;
            padding: 16px;
            background: var(--primary-gradient);
            border: 2px solid rgba(0, 212, 255, 0.3);
            border-radius: 12px;
            color: white;
            font-weight: 700;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 8px 30px rgba(0, 212, 255, 0.4);
            margin-bottom: 15px;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(0, 212, 255, 0.6);
        }

        .btn-secondary {
            background: transparent;
            border: 2px solid var(--neon-cyan);
            color: var(--neon-cyan);
        }

        .btn-secondary:hover {
            background: var(--neon-cyan);
            color: white;
        }

        /* ========== Ê∂àÊÅØÊèêÁ§∫ ========== */
        #message {
            position: fixed;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 9998;
            width: 90%;
            max-width: 600px;
        }

        /* ========== ÈÇÄËØ∑‰∫∫ÂºπÁ™óÊ†∑Âºè ========== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            animation: fadeIn 0.3s;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.1) 0%, rgba(255, 0, 255, 0.1) 100%);
            border: 2px solid rgba(0, 212, 255, 0.5);
            border-radius: 25px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0, 212, 255, 0.3);
            animation: slideUp 0.3s;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal h3 {
            font-size: 28px;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            text-align: center;
        }

        .modal p {
            color: var(--text-secondary);
            text-align: center;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .modal-input {
            width: 100%;
            padding: 15px;
            background: rgba(0, 212, 255, 0.05);
            border: 2px solid rgba(0, 212, 255, 0.3);
            border-radius: 12px;
            color: white;
            font-size: 16px;
            margin-bottom: 20px;
        }

        .modal-input:focus {
            outline: none;
            border-color: var(--neon-cyan);
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.3);
        }

        .modal-buttons {
            display: flex;
            gap: 15px;
        }

        .modal-buttons button {
            flex: 1;
            padding: 15px;
            font-size: 16px;
            font-weight: 700;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .modal-btn-primary {
            background: var(--primary-gradient);
            border: 2px solid transparent;
            color: white;
        }

        .modal-btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(0, 212, 255, 0.5);
        }

        .modal-btn-secondary {
            background: transparent;
            border: 2px solid var(--neon-cyan);
            color: var(--neon-cyan);
        }

        .modal-btn-secondary:hover {
            background: rgba(0, 212, 255, 0.1);
        }

        /* ========== ÂìçÂ∫îÂºè ========== */
        @media (max-width: 768px) {
            .page-title h1 { font-size: 36px; }
            .nav-menu { display: none; }
            .lang-switcher { display: none; }
            .navbar .connect-btn { display: none; }
            .hamburger { display: flex; }
            .mobile-connect-btn { display: block; }
            .mining-card { padding: 25px; }
        }
    </style>
</head>
<body>
    <div id="particles-js"></div>

    <!-- ÂØºËà™Ê†è -->
    <nav class="navbar">
        <a href="index.html" class="logo">üêª Debear Party</a>
        <ul class="nav-menu">
            <li><a href="index.html" data-i18n="nav.home">Home</a></li>
            <li><a href="swap.html" data-i18n="nav.swap">Swap</a></li>
            <li><a href="pass-nft.html" data-i18n="nav.pass">Pass NFT</a></li>
            <li><a href="t-engine.html" class="active" data-i18n="nav.tengine">T-Engine</a></li>
            <li><a href="gamefi.html" data-i18n="nav.gamefi">GameFi</a></li>
        </ul>
        <div class="nav-buttons">
            <!-- ËØ≠Ë®ÄÂàáÊç¢Âô® -->
            <div class="lang-switcher">
                <button class="lang-btn">EN</button>
                <div class="lang-dropdown">
                    <div class="lang-option active" data-lang="en" onclick="window.i18n?.setLanguage('en')">
                        <span data-i18n="lang.en">English</span>
                    </div>
                    <div class="lang-option" data-lang="zh-TW" onclick="window.i18n?.setLanguage('zh-TW')">
                        <span data-i18n="lang.zh">ÁπÅÈ´î‰∏≠Êñá</span>
                    </div>
                </div>
            </div>
            <button class="connect-btn" id="connectBtn" onclick="connectWallet()" data-i18n="nav.connect">Connect Wallet</button>
            <button class="hamburger" onclick="toggleMobileMenu()">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>

    <!-- Ê∂àÊÅØÊèêÁ§∫Ê°Ü -->
    <div id="message"></div>

    <!-- ÁßªÂä®Á´ØËèúÂçïÈÅÆÁΩ© -->
    <div class="mobile-menu-overlay" onclick="toggleMobileMenu()"></div>

    <!-- ÁßªÂä®Á´Ø‰æßËæπÊ†èËèúÂçï -->
    <div class="mobile-menu">
        <ul class="mobile-nav-links">
            <li><a href="index.html" data-i18n="nav.home">Home</a></li>
            <li><a href="swap.html" data-i18n="nav.swap">Swap</a></li>
            <li><a href="pass-nft.html" data-i18n="nav.pass">Pass NFT</a></li>
            <li><a href="t-engine.html" class="active" data-i18n="nav.tengine">T-Engine</a></li>
            <li><a href="gamefi.html" data-i18n="nav.gamefi">GameFi</a></li>
        </ul>
        <!-- ÁßªÂä®Á´ØËØ≠Ë®ÄÈÄâÊã© -->
        <div style="margin-top: 20px; padding: 10px 0; border-top: 1px solid rgba(0, 212, 255, 0.2);">
            <div class="lang-option" style="padding: 12px; cursor: pointer;" data-lang="en" onclick="window.i18n?.setLanguage('en')">
                <span data-i18n="lang.en">English</span>
            </div>
            <div class="lang-option" style="padding: 12px; cursor: pointer;" data-lang="zh-TW" onclick="window.i18n?.setLanguage('zh-TW')">
                <span data-i18n="lang.zh">ÁπÅÈ´î‰∏≠Êñá</span>
            </div>
        </div>
        <button class="connect-btn mobile-connect-btn" onclick="connectWallet()" data-i18n="nav.connect">Connect Wallet</button>
    </div>

    <!-- ÈÇÄËØ∑‰∫∫ÂºπÁ™ó -->
    <div class="modal-overlay" id="inviteModal">
        <div class="modal">
            <h3 data-i18n="pass.inviteTitle">üéÅ Enter Referrer Address</h3>
            <p data-i18n="pass.inviteDesc">You are detected as a new user. Please enter referrer address to get rewards, or skip to use default referrer.</p>
            <input type="text" class="modal-input" id="modalInviterInput" placeholder="0x... (ÈÄâÂ°´)">
            <div class="modal-buttons">
                <button class="modal-btn-secondary" onclick="closeInviteModal()" data-i18n="pass.skip">Skip</button>
                <button class="modal-btn-primary" onclick="confirmInviter()" data-i18n="pass.confirm">Confirm</button>
            </div>
        </div>
    </div>

    <!-- ‰∏ªÂÜÖÂÆπ -->
    <div class="container">
        <div class="page-title">
            <h1 data-i18n="tengine.title">‚öôÔ∏è T-Engine</h1>
            <p data-i18n="tengine.subtitle">T-Engine System - Continuously Earn DP Token Rewards</p>
        </div>

        <!-- 1. T-Engine Ë¥®ÊäºÊåñÁüøÔºàÊï¥ÂêàÁ™óÂè£Ôºâ -->
        <div class="mining-container">
            <div class="mining-card" style="position: relative;">
                <!-- ÂÄíËÆ°Êó∂ÁΩÆÂè≥‰∏äËßí -->
                <div style="position: absolute; top: 20px; right: 20px; padding: 10px 20px; background: rgba(0, 212, 255, 0.1); border: 1px solid rgba(0, 212, 255, 0.3); border-radius: 12px; text-align: center;">
                    <div style="color: var(--text-secondary); font-size: 12px; margin-bottom: 4px;" data-i18n="tengine.nextRelease">üìÖÔ∏è Next Release</div>
                    <div id="tengineNextRelease" style="font-size: 18px; font-weight: 700; color: var(--neon-cyan); text-shadow: 0 0 10px rgba(0, 212, 255, 0.5);">--:--:--</div>
                </div>
                
                <h3>‚ööÔ∏è T-Engine</h3>
                
                <!-- Â•ñÂä±ÊòæÁ§∫Âå∫Âüü -->
                <div class="reward-box" style="margin-bottom: 20px;">
                    <div class="reward-label" data-i18n="tengine.pendingReward">Pending Rewards</div>
                    <div class="reward-amount" id="pendingReward">0.0000</div>
                    <div class="reward-label">DP Token</div>
                </div>
                
                <button class="btn-primary" onclick="claimReward()" style="margin-bottom: 25px;" data-i18n="tengine.claimReward">Claim Reward</button>
                
                <!-- ÊåñÁüøÊï∞ÊçÆ -->
                <div style="margin: 25px 0;">
                    <div class="stat">
                        <span class="stat-label" data-i18n="tengine.totalStake">Total Network Stake:</span>
                        <span class="stat-value" id="totalStake">0 DP</span>
                    </div>
                    <div class="stat">
                        <span class="stat-label" data-i18n="tengine.myRemaining">My Remaining Shares:</span>
                        <span class="stat-value" id="myRemaining">0 DP</span>
                    </div>
                    <div class="stat">
                        <span class="stat-label" data-i18n="tengine.myStake">My Stake:</span>
                        <span class="stat-value" id="myStake">0 DP</span>
                    </div>
                    <div class="stat">
                        <span class="stat-label" data-i18n="tengine.totalClaimed">Total Claimed:</span>
                        <span class="stat-value" id="totalClaimed">0 DP</span>
                    </div>
                </div>
                
                <!-- ÂàÜÈöîÁ∫ø -->
                <div style="border-top: 2px solid rgba(0, 212, 255, 0.2); margin: 25px 0;"></div>
                
                <!-- Ë¥®ÊäºÂå∫Âüü -->
                <div class="input-group">
                    <label style="display: flex; justify-content: space-between; align-items: center;">
                        <span data-i18n="tengine.stakeAmount">Stake Amount (DP Token)</span>
                        <span style="color: var(--neon-cyan); font-size: 14px;"><span data-i18n="tengine.balance">Balance:</span> <span id="userDPBalance">0.00</span> DP</span>
                    </label>
                    <div style="position: relative;">
                        <input type="text" id="stakeAmount" placeholder="ËæìÂÖ•Ë¥®ÊäºÊï∞Èáè" style="padding-right: 70px;">
                        <button onclick="setMaxAmount()" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); padding: 6px 15px; background: var(--neon-cyan); color: white; border: none; border-radius: 8px; font-weight: 700; cursor: pointer; transition: all 0.3s;">MAX</button>
                    </div>
                </div>

                <button class="btn-primary" onclick="stake()" data-i18n="tengine.stake">Stake</button>
            </div>
        </div>

        <!-- 2. ‰ªÄ‰πàÊòØ T-Engine -->
        <div class="intro-section">
            <div class="intro-card">
                <h2 data-i18n="tengine.whatIs">üöÄ What is T-Engine?</h2>
                <p data-i18n="tengine.intro1">
                    T-Engine is the core mining engine of the Debear Party ecosystem. By staking DP Tokens, users can start T-Engine for continuous mining and earn generous DP Token rewards.
                </p>
                <p data-i18n="tengine.intro2">
                    T-Engine releases 0.3% of remaining shares daily, ensuring fair distribution and sustainable development. Whether you stake small or large amounts, you can earn corresponding returns.
                </p>
            </div>
        </div>

        <!-- 3. Â¶Ç‰Ωï‰ΩøÁî® -->
        <div class="intro-section">
            <div class="intro-card">
                <h2 data-i18n="tengine.howTo">üîÑ How to Use?</h2>
                <ol style="color: var(--text-secondary); margin-left: 20px; line-height: 2;">
                    <li data-i18n="tengine.step1"><strong>Connect Wallet:</strong> Make sure you have enough DP Tokens in your wallet</li>
                    <li data-i18n="tengine.step2"><strong>Stake Tokens:</strong> Enter stake amount and click "Stake" button</li>
                    <li data-i18n="tengine.step3"><strong>Start Mining:</strong> After successful staking, T-Engine starts automatically</li>
                    <li data-i18n="tengine.step4"><strong>Claim Rewards:</strong> You can claim 0.3% of remaining shares daily, with 10% tax on claims</li>
                    <li data-i18n="tengine.step5"><strong>Continuous Earnings:</strong> Regularly claim rewards and reinvest for higher returns</li>
                </ol>
            </div>
        </div>

        <!-- 4. Ê≥®ÊÑè‰∫ãÈ°π -->
        <div class="intro-section">
            <div class="intro-card">
                <h2 data-i18n="tengine.notice">‚ö†Ô∏è Notice</h2>
                <ul style="color: var(--text-secondary); margin-left: 20px; line-height: 2;">
                    <li data-i18n="tengine.notice1">Staking requires a small amount of Gas fee (BERA)</li>
                    <li data-i18n="tengine.notice2">T-Engine does not support withdrawing stakes, only claiming daily released rewards</li>
                    <li data-i18n="tengine.notice3">Holding Pass NFT grants mining power bonus (Coming Soon)</li>
                    <li data-i18n="tengine.notice4">Smart contracts have been audited, but please invest cautiously</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Á≤íÂ≠êÊïàÊûúÂ∫ì -->
    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
    
    <!-- ÂõΩÈôÖÂåñÈÖçÁΩÆ -->
    <script src="js/i18n.js"></script>
    
    <script>
        // ========== Á≤íÂ≠êËÉåÊôØÈÖçÁΩÆ ==========
        particlesJS('particles-js', {
            particles: {
                number: { value: 80, density: { enable: true, value_area: 800 } },
                color: { value: ['#00d4ff', '#ff00ff'] },
                shape: { type: 'circle' },
                opacity: { value: 0.6, random: true },
                size: { value: 3, random: true },
                line_linked: {
                    enable: true,
                    distance: 150,
                    color: '#00d4ff',
                    opacity: 0.3,
                    width: 1
                },
                move: {
                    enable: true,
                    speed: 1.5,
                    direction: 'none',
                    random: true
                }
            },
            interactivity: {
                detect_on: 'canvas',
                events: {
                    onhover: { enable: true, mode: 'grab' },
                    onclick: { enable: true, mode: 'push' }
                }
            }
        });

        // ========== ÂêàÁ∫¶ÈÖçÁΩÆ ==========
        const CONTRACTS = {
            tEngine: '0xd9661D56659B80A875E42A51955434A0818581D8',
            dpToken: '0xf7C464c7832e59855aa245Ecc7677f54B3460e7d',
            debearPass: '0x29f2a6756E5B79C36Eb6699220CB56f7749C7514'
        };

        // T-Engine ABI
        const TENGINE_ABI = [
            'function enterPool(uint256 amount, address inviter)',
            'function claim()',
            'function userInfo(address) view returns (uint256 totalShares, uint256 claimedShares, uint256 lastClaimEpoch, uint256 pendingRewards)',
            'function totalDeposited() view returns (uint256)',
            'function totalClaimed() view returns (uint256)',
            'function deployTime() view returns (uint256)',
            'function getCurrentEpoch() view returns (uint256)',
            'function calculateClaimable(address user) view returns (uint256)'
        ];

        const INVITATION_ABI = [
            'function getInviter(address) view returns (address)'
        ];

        const TOKEN_ABI = [
            'function approve(address spender, uint256 amount) external returns (bool)',
            'function balanceOf(address account) external view returns (uint256)',
            'function allowance(address owner, address spender) external view returns (uint256)'
        ];

        const INVITATION_SYSTEM = '0xAa733E91132dF624f391f1B426F56BD231486774';
        const DEFAULT_INVITER = '0xfcbd23bdd16f0e10437ef26b4df3afb12e75a05d';

        let provider, signer, userAddress;
        let updateInterval, tengineCountdownInterval;
        let userDPBalance = '0';
        let userInviter = null;
        let pendingStakeAmount = null;

        // ========== ËøûÊé•Èí±ÂåÖ ==========
        async function connectWallet() {
            try {
                const walletProvider = window.okxwallet || window.ethereum;
                if (!walletProvider) {
                    showMessage('ËØ∑ÂÆâË£Ö MetaMask Êàñ OKX Wallet', 'error');
                    return;
                }

                await walletProvider.request({ method: 'eth_requestAccounts' });
                
                const chainId = await walletProvider.request({ method: 'eth_chainId' });
                if (chainId !== '0x138de') {
                    await walletProvider.request({
                        method: 'wallet_switchEthereumChain',
                        params: [{ chainId: '0x138de' }]
                    });
                }

                provider = new ethers.providers.Web3Provider(walletProvider);
                signer = provider.getSigner();
                userAddress = await signer.getAddress();

                const shortAddr = userAddress.substring(0, 6) + '...' + userAddress.substring(38);
                document.getElementById('connectBtn').textContent = shortAddr;
                
                // ‰øùÂ≠òËøûÊé•Áä∂ÊÄÅ
                localStorage.setItem('walletConnected', 'true');
                localStorage.setItem('walletAddress', userAddress);
                
                // Ê£ÄÊü•ÈÇÄËØ∑ÂÖ≥Á≥ª
                await checkInviter();
                
                await refreshData();
                await refreshDPBalance();
                startRealtimeUpdate();
                showMessage('Èí±ÂåÖËøûÊé•ÊàêÂäüÔºÅ', 'success');
            } catch (error) {
                showMessage('ËøûÊé•Èí±ÂåÖÂ§±Ë¥•: ' + error.message, 'error');
            }
        }

        // Ê£ÄÊü•Âπ∂ÊÅ¢Â§çÈí±ÂåÖËøûÊé•
        async function checkWalletConnection() {
            const wasConnected = localStorage.getItem('walletConnected');
            if (!wasConnected) return;

            try {
                const walletProvider = window.okxwallet || window.ethereum;
                if (!walletProvider) return;

                // ÂÖàÊ£ÄÊü•ÁΩëÁªú
                const chainId = await walletProvider.request({ method: 'eth_chainId' });
                if (chainId !== '0x138de') {
                    console.log('Wrong network, need to switch to Berachain');
                    localStorage.removeItem('walletConnected');
                    localStorage.removeItem('walletAddress');
                    return;
                }

                const accounts = await walletProvider.request({ method: 'eth_accounts' });
                if (accounts && accounts.length > 0) {
                    provider = new ethers.providers.Web3Provider(walletProvider, 'any');
                    signer = provider.getSigner();
                    userAddress = await signer.getAddress();

                    const shortAddr = userAddress.substring(0, 6) + '...' + userAddress.substring(38);
                    document.getElementById('connectBtn').textContent = shortAddr;

                    localStorage.setItem('walletAddress', userAddress);

                    await checkInviter();
                    await refreshData();
                    await refreshDPBalance();
                    startRealtimeUpdate();
                } else {
                    localStorage.removeItem('walletConnected');
                    localStorage.removeItem('walletAddress');
                }
            } catch (error) {
                console.error('Error checking wallet connection:', error);
                localStorage.removeItem('walletConnected');
                localStorage.removeItem('walletAddress');
            }
        }

        // È°µÈù¢Âä†ËΩΩÊó∂Ê£ÄÊü•Èí±ÂåÖËøûÊé•
        window.addEventListener('load', () => {
            checkWalletConnection();
        });

        // ========== Ê£ÄÊü•ÈÇÄËØ∑ÂÖ≥Á≥ª ==========
        async function checkInviter() {
            try {
                const invitation = new ethers.Contract(INVITATION_SYSTEM, INVITATION_ABI, provider);
                const inviter = await invitation.getInviter(userAddress);
                
                if (inviter === ethers.constants.AddressZero) {
                    // Êñ∞Áî®Êà∑Ôºå‰ΩøÁî®ÈªòËÆ§ÈÇÄËØ∑‰∫∫
                    userInviter = DEFAULT_INVITER;
                } else {
                    // Â∑≤ÊúâÈÇÄËØ∑‰∫∫
                    userInviter = inviter;
                }
            } catch (error) {
                console.error('Ê£ÄÊü•ÈÇÄËØ∑ÂÖ≥Á≥ªÂ§±Ë¥•:', error);
                userInviter = DEFAULT_INVITER;
            }
        }

        // ========== ËøõÂÖ•ÁüøÊ±† ==========
        async function stake() {
            if (!signer) {
                showMessage('ËØ∑ÂÖàËøûÊé•Èí±ÂåÖ', 'error');
                return;
            }

            const amount = document.getElementById('stakeAmount').value;
            if (!amount || parseFloat(amount) <= 0) {
                showMessage('ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑË¥®ÊäºÊï∞Èáè', 'error');
                return;
            }

            // Ê£ÄÊü•ÊòØÂê¶ÊòØÊñ∞Áî®Êà∑ÔºàÊ≤°ÊúâÈÇÄËØ∑‰∫∫Ôºâ
            if (userInviter === DEFAULT_INVITER) {
                // ÊòæÁ§∫ÂºπÁ™óËÆ©Áî®Êà∑ËæìÂÖ•ÈÇÄËØ∑‰∫∫
                pendingStakeAmount = amount;
                showInviteModal();
                return;
            }

            // ÊâßË°åË¥®Êäº
            await executeStake(amount, userInviter);
        }

        // ========== ÊâßË°åË¥®Êäº ==========
        async function executeStake(amount, inviter) {
            try {
                const amountWei = ethers.utils.parseEther(amount);
                const token = new ethers.Contract(CONTRACTS.dpToken, TOKEN_ABI, signer);
                const tEngine = new ethers.Contract(CONTRACTS.tEngine, TENGINE_ABI, signer);

                // Ê£ÄÊü•ÊéàÊùÉ
                const allowance = await token.allowance(userAddress, CONTRACTS.tEngine);
                if (allowance.lt(amountWei)) {
                    showMessage('Ê≠£Âú®ÊéàÊùÉ...', 'info');
                    const approveTx = await token.approve(CONTRACTS.tEngine, ethers.constants.MaxUint256);
                    await approveTx.wait();
                }

                showMessage('Ê≠£Âú®Ë¥®Êäº...', 'info');
                const tx = await tEngine.enterPool(amountWei, inviter);
                await tx.wait();

                showMessage('Ë¥®ÊäºÊàêÂäüÔºÅT-Engine Â∑≤ÂêØÂä®', 'success');
                
                // Êõ¥Êñ∞ÈÇÄËØ∑ÂÖ≥Á≥ª
                userInviter = inviter;
                
                document.getElementById('stakeAmount').value = '';
                await refreshData();
                await refreshDPBalance();
            } catch (error) {
                showMessage('Ë¥®ÊäºÂ§±Ë¥•: ' + error.message, 'error');
            }
        }

        // ========== ÊòæÁ§∫ÈÇÄËØ∑‰∫∫ÂºπÁ™ó ==========
        function showInviteModal() {
            document.getElementById('inviteModal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // ========== ÂÖ≥Èó≠ÈÇÄËØ∑‰∫∫ÂºπÁ™ó ==========
        function closeInviteModal() {
            document.getElementById('inviteModal').classList.remove('active');
            document.body.style.overflow = '';
            document.getElementById('modalInviterInput').value = '';
            
            // ‰ΩøÁî®ÈªòËÆ§ÈÇÄËØ∑‰∫∫
            if (pendingStakeAmount) {
                executeStake(pendingStakeAmount, DEFAULT_INVITER);
                pendingStakeAmount = null;
            }
        }

        // ========== Á°ÆËÆ§ÈÇÄËØ∑‰∫∫ ==========
        function confirmInviter() {
            const inviterInput = document.getElementById('modalInviterInput').value.trim();
            const inviter = inviterInput || DEFAULT_INVITER;
            
            closeInviteModal();
            
            if (pendingStakeAmount) {
                executeStake(pendingStakeAmount, inviter);
                pendingStakeAmount = null;
            }
        }

        // T-Engine‰∏çÊîØÊåÅÂèñÂõûÔºåÈöêËóèÊ≠§ÂäüËÉΩ
        async function unstake() {
            showMessage('T-Engine ‰∏çÊîØÊåÅÂèñÂõûË¥®ÊäºÔºå‰ªÖËÉΩÈ¢ÜÂèñÂ•ñÂä±', 'error');
        }

        // ========== È¢ÜÂèñÂ•ñÂä± ==========
        async function claimReward() {
            if (!signer) {
                showMessage('ËØ∑ÂÖàËøûÊé•Èí±ÂåÖ', 'error');
                return;
            }

            try {
                const tEngine = new ethers.Contract(CONTRACTS.tEngine, TENGINE_ABI, signer);
                
                showMessage('Ê≠£Âú®È¢ÜÂèñÂ•ñÂä±...', 'info');
                const tx = await tEngine.claim();
                await tx.wait();

                showMessage('Â•ñÂä±È¢ÜÂèñÊàêÂäüÔºÅ', 'success');
                await refreshData();
            } catch (error) {
                showMessage('È¢ÜÂèñÂ§±Ë¥•: ' + error.message, 'error');
            }
        }

        // ========== Âà∑Êñ∞Êï∞ÊçÆ ==========
        async function refreshData() {
            if (!provider || !userAddress) return;

            try {
                const tEngine = new ethers.Contract(CONTRACTS.tEngine, TENGINE_ABI, provider);

                // Ëé∑ÂèñÁî®Êà∑‰ø°ÊÅØ
                const userInfo = await tEngine.userInfo(userAddress);
                console.log('üîç TEngine userInfo:', userInfo);

                // Ëß£ÊûêÊï∞ÊçÆ
                let totalShares, claimedShares, lastClaimEpoch, pendingRewards;
                
                if (Array.isArray(userInfo)) {
                    totalShares = userInfo[0];
                    claimedShares = userInfo[1];
                    lastClaimEpoch = userInfo[2];
                    pendingRewards = userInfo[3];
                } else {
                    totalShares = userInfo.totalShares || userInfo[0];
                    claimedShares = userInfo.claimedShares || userInfo[1];
                    lastClaimEpoch = userInfo.lastClaimEpoch || userInfo[2];
                    pendingRewards = userInfo.pendingRewards || userInfo[3];
                }

                // Â∞ùËØïË∞ÉÁî® calculateClaimable Ëé∑ÂèñÂÆûÊó∂ÂèØÈ¢ÜÂèñÊï∞Èáè
                let actualClaimable = pendingRewards;
                try {
                    const claimable = await tEngine.calculateClaimable(userAddress);
                    console.log('‚úÖ calculateClaimable:', ethers.utils.formatEther(claimable));
                    actualClaimable = claimable;
                } catch (calcError) {
                    console.log('üîç ÂêàÁ∫¶Êú™Êèê‰æõ calculateClaimableÔºå‰ΩøÁî®ÊâãÂä®ËÆ°ÁÆóÊ®°Âºè');
                    
                    // ÊâãÂä®ËÆ°ÁÆóÔºöÈÄíÂáèÈáäÊîæÊú∫Âà∂ 0.3%
                    try {
                        const currentEpoch = await tEngine.getCurrentEpoch();
                        console.log('üóìÔ∏è currentEpoch:', currentEpoch.toString());
                        console.log('üóìÔ∏è lastClaimEpoch:', lastClaimEpoch.toString());
                        
                        const epochDiff = currentEpoch.sub(lastClaimEpoch);
                        if (epochDiff.gt(0)) {
                            // ÈÄíÂáèÈáäÊîæËÆ°ÁÆó
                            const remainingShares = totalShares.sub(claimedShares);
                            let currentRemaining = remainingShares;
                            let totalClaimable = ethers.BigNumber.from(0);
                            
                            for (let i = 0; i < Number(epochDiff); i++) {
                                const dayRelease = currentRemaining.mul(3).div(1000);
                                totalClaimable = totalClaimable.add(dayRelease);
                                currentRemaining = currentRemaining.sub(dayRelease);
                            }
                            
                            actualClaimable = totalClaimable;
                            console.log('üí∞ ÊâãÂä®ËÆ°ÁÆóÁªìÊûú:', ethers.utils.formatEther(actualClaimable));
                        }
                    } catch (epochError) {
                        console.error('‚ö†Ô∏è Ëé∑Âèñ epoch Â§±Ë¥•:', epochError);
                    }
                }

                // ËÆ°ÁÆóÊòæÁ§∫Êï∞ÊçÆ
                const stakedAmount = totalShares.div(4);
                const remainingShares = totalShares.sub(claimedShares).sub(actualClaimable);

                // Êõ¥Êñ∞È°µÈù¢
                document.getElementById('myStake').textContent = parseFloat(ethers.utils.formatEther(stakedAmount)).toFixed(2) + ' DP';
                document.getElementById('myRemaining').textContent = parseFloat(ethers.utils.formatEther(remainingShares)).toFixed(2) + ' DP';
                document.getElementById('pendingReward').textContent = parseFloat(ethers.utils.formatEther(actualClaimable)).toFixed(4);
                document.getElementById('totalClaimed').textContent = parseFloat(ethers.utils.formatEther(claimedShares)).toFixed(2) + ' DP';
                
                // Ëé∑ÂèñÂÖ®ÁΩëÊï∞ÊçÆ
                try {
                    const totalDeposited = await tEngine.totalDeposited();
                    document.getElementById('totalStake').textContent = parseFloat(ethers.utils.formatEther(totalDeposited)).toFixed(4) + ' DP';
                } catch (e) {
                    console.warn('Ëé∑ÂèñÂÖ®ÁΩëÊï∞ÊçÆÂ§±Ë¥•:', e);
                }
                
                // ËÆ°ÁÆó‰∏ãÊ¨°ÈáäÊîæÂÄíËÆ°Êó∂
                try {
                    const [deployTimeBN, latestBlock] = await Promise.all([
                        tEngine.deployTime(),
                        provider.getBlock('latest')
                    ]);
                    const deployTime = Number(deployTimeBN.toString());
                    const now = Number(latestBlock.timestamp);
                    const SECONDS_PER_DAY = 86400;
                    const elapsedDays = Math.floor((now - deployTime) / SECONDS_PER_DAY);
                    const nextEpochStart = deployTime + (elapsedDays + 1) * SECONDS_PER_DAY;
                    startTengineCountdown(nextEpochStart);
                } catch (err) {
                    console.warn('ÂÄíËÆ°Êó∂ËÆ°ÁÆóÂ§±Ë¥•:', err);
                    document.getElementById('tengineNextRelease').textContent = '--:--:--';
                }

            } catch (error) {
                console.error('Âà∑Êñ∞Êï∞ÊçÆÂ§±Ë¥•:', error);
            }
        }

        // ========== ÊòæÁ§∫Ê∂àÊÅØ ==========
        function showMessage(text, type = 'info') {
            const messageDiv = document.getElementById('message');
            messageDiv.innerHTML = `<div class="alert ${type}">${text}</div>`;
            setTimeout(() => { messageDiv.innerHTML = ''; }, 5000);
        }

        // ========== ÁßªÂä®Á´ØËèúÂçïÂàáÊç¢ ==========
        function toggleMobileMenu() {
            const hamburger = document.querySelector('.hamburger');
            const mobileMenu = document.querySelector('.mobile-menu');
            const overlay = document.querySelector('.mobile-menu-overlay');
            
            hamburger.classList.toggle('active');
            mobileMenu.classList.toggle('active');
            overlay.classList.toggle('active');
            
            if (mobileMenu.classList.contains('active')) {
                document.body.style.overflow = 'hidden';
            } else {
                document.body.style.overflow = '';
            }
        }

        // ========== Âà∑Êñ∞DP‰ΩôÈ¢ù ==========
        async function refreshDPBalance() {
            if (!provider || !userAddress) return;
            
            try {
                const dpToken = new ethers.Contract(CONTRACTS.dpToken, TOKEN_ABI, provider);
                const balance = await dpToken.balanceOf(userAddress);
                userDPBalance = ethers.utils.formatEther(balance);
                document.getElementById('userDPBalance').textContent = parseFloat(userDPBalance).toFixed(2);
            } catch (error) {
                console.error('Ëé∑ÂèñDP‰ΩôÈ¢ùÂ§±Ë¥•:', error);
            }
        }
        
        // ========== ËÆæÁΩÆÊúÄÂ§ßÈáè ==========
        function setMaxAmount() {
            if (!userAddress) {
                showMessage('ËØ∑ÂÖàËøûÊé•Èí±ÂåÖ', 'error');
                return;
            }
            document.getElementById('stakeAmount').value = userDPBalance;
        }
        
        // ========== ÂêØÂä®ÂÆûÊó∂Êõ¥Êñ∞ ==========
        function startRealtimeUpdate() {
            if (updateInterval) clearInterval(updateInterval);
            updateInterval = setInterval(() => {
                refreshData();
                refreshDPBalance();
            }, 10000); // ÊØè10ÁßíÂà∑Êñ∞
        }
        
        // ========== T-Engine ÂÄíËÆ°Êó∂ ==========
        function startTengineCountdown(targetSec) {
            const el = document.getElementById('tengineNextRelease');
            if (!el) return;
            if (tengineCountdownInterval) clearInterval(tengineCountdownInterval);

            function pad(n) { return String(n).padStart(2, '0'); }
            function tick() {
                const nowMs = Date.now();
                const diffMs = targetSec * 1000 - nowMs;
                if (diffMs <= 0) {
                    el.textContent = '00:00:00';
                    clearInterval(tengineCountdownInterval);
                    // Âà∑Êñ∞Êï∞ÊçÆ
                    setTimeout(refreshData, 1500);
                    return;
                }
                const totalSec = Math.floor(diffMs / 1000);
                const h = Math.floor(totalSec / 3600);
                const m = Math.floor((totalSec % 3600) / 60);
                const s = totalSec % 60;
                el.textContent = `${pad(h)}:${pad(m)}:${pad(s)}`;
            }

            tick();
            tengineCountdownInterval = setInterval(tick, 1000);
        }
    </script>
</body>
</html>
