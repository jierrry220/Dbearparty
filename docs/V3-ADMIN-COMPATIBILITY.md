# TEngineV3 ä¸ admin.html åŠŸèƒ½å…¼å®¹æ€§éªŒè¯

## âœ… éªŒè¯ç»“æœï¼šå®Œå…¨å…¼å®¹

TEngineV3åˆçº¦çš„Ownerç®¡ç†åŠŸèƒ½ä¸admin.htmlä¸­çš„T-Engineæ§åˆ¶é¢æ¿**å®Œå…¨å…¼å®¹**ï¼Œæ— éœ€ä¿®æ”¹å‰ç«¯ä»£ç ã€‚

---

## ğŸ“Š åŠŸèƒ½å¯¹æ¯”è¡¨

| admin.html åŠŸèƒ½ | æ–¹æ³•å | TEngineV3 | V2å¯¹æ¯” | è¯´æ˜ |
|----------------|--------|-----------|--------|------|
| **è®¾ç½®ä»½é¢å€æ•°** | `setSharesMultiplier(uint256)` | âœ… å­˜åœ¨ | ç›¸åŒ | æ— éœ€ä¿®æ”¹ |
| **è®¾ç½®æ¯æ—¥é‡Šæ”¾ç‡** | `setDailyReleaseRate(uint256)` | âœ… å­˜åœ¨ | ç›¸åŒ | æ— éœ€ä¿®æ”¹ |
| **æš‚åœ/æ¢å¤é¢†å–** | `setClaimPaused(bool)` | âœ… å­˜åœ¨ | ç›¸åŒ | æ— éœ€ä¿®æ”¹ |
| **è®¾ç½®ç¨ç‡** | `setTaxRate(uint256)` | âœ… å­˜åœ¨ | ç›¸åŒ | æ— éœ€ä¿®æ”¹ |
| **è®¾ç½®ç¨è´¹æ¥æ”¶åœ°å€** | `setTaxRecipient(address)` | âœ… å­˜åœ¨ | ç›¸åŒ | æ— éœ€ä¿®æ”¹ |
| **è®¾ç½®é‡Šæ”¾å‘¨æœŸæ—¶é•¿** | `setEpochDuration(uint256)` | âœ… å­˜åœ¨ | ç›¸åŒ | V2æ–°å¢ï¼Œä¿ç•™ |
| **å¼ºåˆ¶æå‰é‡Šæ”¾** | `forceReleaseOneEpoch()` | âœ… å­˜åœ¨ | ç›¸åŒ | V2æ–°å¢ï¼Œä¿ç•™ |
| **è®¾ç½®DebearPass** | `setDebearPass(address)` | âœ… å­˜åœ¨ | ç›¸åŒ | é¢å¤–åŠŸèƒ½ |

### è¯»å–æ–¹æ³•å…¼å®¹æ€§

| admin.html è¯»å– | æ–¹æ³•å | TEngineV3 | V2å¯¹æ¯” | è¯´æ˜ |
|----------------|--------|-----------|--------|------|
| **ä»½é¢å€æ•°** | `sharesMultiplier()` | âœ… å­˜åœ¨ | ç›¸åŒ | æ— éœ€ä¿®æ”¹ |
| **æ¯æ—¥é‡Šæ”¾ç‡** | `dailyReleaseRate()` | âœ… å­˜åœ¨ | ç›¸åŒ | æ— éœ€ä¿®æ”¹ |
| **æš‚åœçŠ¶æ€** | `claimPaused()` | âœ… å­˜åœ¨ | ç›¸åŒ | æ— éœ€ä¿®æ”¹ |
| **ç¨ç‡** | `taxRate()` | âœ… å­˜åœ¨ | ç›¸åŒ | æ— éœ€ä¿®æ”¹ |
| **ç¨è´¹æ¥æ”¶åœ°å€** | `taxRecipient()` | âœ… å­˜åœ¨ | ç›¸åŒ | æ— éœ€ä¿®æ”¹ |
| **çŸ¿æ± ä½™é¢** | `getPoolBalance()` | âœ… å­˜åœ¨ | ç›¸åŒ | æ— éœ€ä¿®æ”¹ |
| **ç´¯è®¡è´¨æŠ¼** | `totalDeposited()` | âœ… å­˜åœ¨ | ç›¸åŒ | æ— éœ€ä¿®æ”¹ |
| **ç´¯è®¡é¢†å–** | `totalClaimed()` | âœ… å­˜åœ¨ | ç›¸åŒ | æ— éœ€ä¿®æ”¹ |
| **é‡Šæ”¾å‘¨æœŸæ—¶é•¿** | `epochDuration()` | âœ… å­˜åœ¨ | ç›¸åŒ | æ— éœ€ä¿®æ”¹ |
| **å½“å‰Epoch** | `getCurrentEpoch()` | âœ… å­˜åœ¨ | ç›¸åŒ | æ— éœ€ä¿®æ”¹ |
| **Owneråœ°å€** | `owner()` | âœ… ç»§æ‰¿ | ç›¸åŒ | OwnableUpgradeable |

---

## ğŸ†• V3æ–°å¢åŠŸèƒ½ï¼ˆå¯é€‰å‡çº§admin.htmlï¼‰

è™½ç„¶admin.htmlå½“å‰ä¸åŒ…å«ä»¥ä¸‹V3æ–°åŠŸèƒ½ï¼Œä½†å¯ä»¥é€‰æ‹©æ€§æ·»åŠ åˆ°å‰ç«¯ï¼š

| V3æ–°å¢åŠŸèƒ½ | æ–¹æ³•å | è¯´æ˜ | æ˜¯å¦å¿…éœ€ |
|-----------|--------|------|---------|
| **æŸ¥è¯¢é‚€è¯·ç»Ÿè®¡** | `getUserInviteStats(address)` | è¿”å›ç”¨æˆ·è½¬å‡º/æ”¶åˆ°çš„é‚€è¯·å¥–åŠ±ä»½é¢ | å¯é€‰ |
| **æŸ¥è¯¢å®Œæ•´ç”¨æˆ·ä¿¡æ¯** | `getUserFullInfo(address)` | åŒ…å«é‚€è¯·ç»Ÿè®¡çš„å®Œæ•´ç”¨æˆ·ä¿¡æ¯ | å¯é€‰ |
| **ç´¯è®¡é‚€è¯·è½¬ç§»æ€»é‡** | `totalInviteRewardsTransferred()` | å…¨å±€é‚€è¯·ä»½é¢è½¬ç§»ç»Ÿè®¡ | å¯é€‰ |

### å»ºè®®æ·»åŠ çš„admin.htmlæ–°å¡ç‰‡ï¼ˆå¯é€‰ï¼‰

```html
<!-- V3 é‚€è¯·ç»Ÿè®¡å¡ç‰‡ -->
<div class="card">
  <h2>ğŸ“Š V3 é‚€è¯·ç»Ÿè®¡ï¼ˆæ–°å¢ï¼‰</h2>
  <div class="muted" style="margin-bottom:8px;">ç›‘æ§é‚€è¯·å¥–åŠ±ä»½é¢è½¬ç§»æƒ…å†µ</div>
  <div style="margin-top:10px;">
    <div class="stat"><span>ç´¯è®¡è½¬ç§»ä»½é¢æ€»é‡</span><span id="v3TotalTransferred">--</span></div>
    <div class="stat"><span>é‚€è¯·æœºåˆ¶</span><span style="color:#86efac;">ä»é‚€è¯·äººä»½é¢è½¬ç§»ï¼ˆV3ï¼‰âœ…</span></div>
  </div>
  
  <div class="group" style="margin-top:12px;">
    <label>æŸ¥è¯¢ç”¨æˆ·é‚€è¯·ç»Ÿè®¡</label>
    <input id="v3UserAddr" placeholder="è¾“å…¥ç”¨æˆ·åœ°å€ 0x..." />
  </div>
  <button class="btn secondary" id="btnQueryV3Stats">æŸ¥è¯¢</button>
  
  <div style="margin-top:10px;" id="v3StatsResult"></div>
  <div class="msg" id="msgV3Stats"></div>
</div>
```

---

## ğŸ”§ admin.html ABI å…¼å®¹æ€§

### å½“å‰admin.htmlä¸­çš„TENGINE_ABIï¼ˆè¡Œ283-304ï¼‰

```javascript
const TENGINE_ABI = [
  'function setSharesMultiplier(uint256)',           // âœ… å…¼å®¹
  'function sharesMultiplier() view returns (uint256)',  // âœ… å…¼å®¹
  'function setDailyReleaseRate(uint256)',           // âœ… å…¼å®¹
  'function dailyReleaseRate() view returns (uint256)', // âœ… å…¼å®¹
  'function setClaimPaused(bool)',                   // âœ… å…¼å®¹
  'function claimPaused() view returns (bool)',      // âœ… å…¼å®¹
  'function setTaxRate(uint256)',                    // âœ… å…¼å®¹
  'function taxRate() view returns (uint256)',       // âœ… å…¼å®¹
  'function setTaxRecipient(address)',               // âœ… å…¼å®¹
  'function taxRecipient() view returns (address)',  // âœ… å…¼å®¹
  'function totalDeposited() view returns (uint256)', // âœ… å…¼å®¹
  'function totalClaimed() view returns (uint256)',   // âœ… å…¼å®¹
  'function totalTaxCollected() view returns (uint256)', // âš ï¸ V3æœªå®ç°
  'function totalInviteRewards() view returns (uint256)', // âš ï¸ V3å·²æ”¹å
  'function getPoolBalance() view returns (uint256)', // âœ… å…¼å®¹
  'function setEpochDuration(uint256)',              // âœ… å…¼å®¹
  'function epochDuration() view returns (uint256)', // âœ… å…¼å®¹
  'function forceReleaseOneEpoch()',                 // âœ… å…¼å®¹
  'function getCurrentEpoch() view returns (uint256)', // âœ… å…¼å®¹
  'function owner() view returns (address)'          // âœ… å…¼å®¹ï¼ˆç»§æ‰¿ï¼‰
];
```

### âš ï¸ éœ€è¦æ³¨æ„çš„å·®å¼‚

| æ–¹æ³• | V2 | V3 | å½±å“ | è§£å†³æ–¹æ¡ˆ |
|------|----|----|------|---------|
| `totalTaxCollected()` | âœ… å­˜åœ¨ | âŒ æœªå®ç° | admin.htmlå¯èƒ½è¯»å–å¤±è´¥ | å¯é€‰ï¼šæ·»åŠ åˆ°V3æˆ–å¿½ç•¥ |
| `totalInviteRewards()` | âœ… å­˜åœ¨ | âœ… æ”¹åä¸º`totalInviteRewardsTransferred` | admin.htmlå¯èƒ½è¯»å–å¤±è´¥ | æ›´æ–°ABIæˆ–æ·»åŠ å…¼å®¹æ–¹æ³• |

---

## ğŸ› ï¸ å»ºè®®çš„V3åˆçº¦è¡¥ä¸ï¼ˆå¯é€‰ï¼‰

å¦‚æœä¸æƒ³ä¿®æ”¹admin.htmlï¼Œå¯ä»¥åœ¨TEngineV3ä¸­æ·»åŠ å‘åå…¼å®¹æ–¹æ³•ï¼š

```solidity
// åœ¨TEngineV3ä¸­æ·»åŠ ä»¥ä¸‹æ–¹æ³•ï¼ˆå‘åå…¼å®¹ï¼‰

/// @notice å‘åå…¼å®¹ï¼šV2çš„totalInviteRewardsæ”¹åä¸ºV3çš„totalInviteRewardsTransferred
function totalInviteRewards() external view returns (uint256) {
    return totalInviteRewardsTransferred;
}

/// @notice å‘åå…¼å®¹ï¼šV3ä¸å†è·Ÿè¸ªtotalTaxCollectedï¼Œè¿”å›0
function totalTaxCollected() external view returns (uint256) {
    return 0; // V3ä¸å†å•ç‹¬ç»Ÿè®¡ï¼Œç¨è´¹ä»claimæ—¶è®¡ç®—
}
```

### æ·»åŠ å…¼å®¹æ–¹æ³•åçš„å®Œæ•´å…¼å®¹æ€§

å¦‚æœæ·»åŠ ä¸Šè¿°2ä¸ªå…¼å®¹æ–¹æ³•ï¼ŒTEngineV3å°†**100%å…¼å®¹**admin.htmlçš„æ‰€æœ‰è¯»å–æ“ä½œã€‚

---

## ğŸ“ å‡çº§åadmin.htmlæ£€æŸ¥æ¸…å•

### åŸºç¡€åŠŸèƒ½ï¼ˆåº”å…¨éƒ¨æ­£å¸¸ï¼‰

- [ ] **è¿æ¥é’±åŒ…** - æ­£å¸¸è¿æ¥
- [ ] **è¯»å–OwnerçŠ¶æ€** - æ˜¾ç¤º"Owner å·²éªŒè¯"
- [ ] **è¯»å–çŸ¿æ± ä½™é¢** - æ­£å¸¸æ˜¾ç¤ºT-Engineæ± ä½™é¢
- [ ] **è¯»å–ä»½é¢å€æ•°** - æ˜¾ç¤ºå½“å‰å€æ•°ï¼ˆå¦‚4xï¼‰
- [ ] **è¯»å–æ¯æ—¥é‡Šæ”¾ç‡** - æ˜¾ç¤ºå½“å‰é‡Šæ”¾ç‡ï¼ˆå¦‚30ä¸‡åˆ†æ¯”ï¼‰
- [ ] **è¯»å–é‡Šæ”¾å‘¨æœŸæ—¶é•¿** - æ˜¾ç¤ºå½“å‰å‘¨æœŸï¼ˆå¦‚86400ç§’ï¼‰
- [ ] **è¯»å–å½“å‰Epoch** - æ˜¾ç¤ºå½“å‰epochæ•°
- [ ] **è¯»å–æš‚åœçŠ¶æ€** - æ˜¾ç¤º"è¿è¡Œä¸­"æˆ–"å·²æš‚åœ"
- [ ] **è¯»å–ç¨è´¹é…ç½®** - æ˜¾ç¤ºç¨ç‡å’Œæ¥æ”¶åœ°å€
- [ ] **è¯»å–ç´¯è®¡è´¨æŠ¼** - æ˜¾ç¤ºtotalDeposited
- [ ] **è¯»å–ç´¯è®¡é¢†å–** - æ˜¾ç¤ºtotalClaimed

### ç®¡ç†åŠŸèƒ½ï¼ˆOwneræ“ä½œï¼‰

- [ ] **è®¾ç½®ä»½é¢å€æ•°** - å¯æˆåŠŸè°ƒç”¨setSharesMultiplier
- [ ] **è®¾ç½®æ¯æ—¥é‡Šæ”¾ç‡** - å¯æˆåŠŸè°ƒç”¨setDailyReleaseRate
- [ ] **è®¾ç½®é‡Šæ”¾å‘¨æœŸæ—¶é•¿** - å¯æˆåŠŸè°ƒç”¨setEpochDuration
- [ ] **æš‚åœ/æ¢å¤é¢†å–** - å¯åˆ‡æ¢claimPausedçŠ¶æ€
- [ ] **è®¾ç½®ç¨ç‡** - å¯æˆåŠŸè°ƒç”¨setTaxRate
- [ ] **è®¾ç½®ç¨è´¹æ¥æ”¶åœ°å€** - å¯æˆåŠŸè°ƒç”¨setTaxRecipient
- [ ] **å¼ºåˆ¶æå‰é‡Šæ”¾** - å¯æˆåŠŸè°ƒç”¨forceReleaseOneEpoch
- [ ] **è½¬å…¥DPåˆ°T-Engineæ± ** - å¯æ­£å¸¸è½¬è´¦

### å¯èƒ½çš„é—®é¢˜ï¼ˆéå…³é”®ï¼‰

- [ ] **totalTaxCollectedæ˜¾ç¤º** - å¯èƒ½æ˜¾ç¤º"--"æˆ–è¯»å–å¤±è´¥ï¼ˆV3æœªå®ç°ï¼‰
- [ ] **totalInviteRewardsæ˜¾ç¤º** - å¯èƒ½æ˜¾ç¤º"--"æˆ–è¯»å–å¤±è´¥ï¼ˆV3æ”¹åï¼‰

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. **æ–¹æ¡ˆAï¼ˆæ¨èï¼‰**ï¼šåœ¨TEngineV3ä¸­æ·»åŠ 2ä¸ªå…¼å®¹æ–¹æ³•ï¼ˆè§ä¸Šæ–‡ï¼‰
2. **æ–¹æ¡ˆB**ï¼šæ›´æ–°admin.htmlçš„ABIï¼Œç§»é™¤è¿™2ä¸ªæ–¹æ³•æˆ–æ›¿æ¢ä¸ºV3æ–°æ–¹æ³•
3. **æ–¹æ¡ˆC**ï¼šå¿½ç•¥è¿™2ä¸ªéå…³é”®å­—æ®µçš„æ˜¾ç¤ºé”™è¯¯

---

## ğŸ¯ æµ‹è¯•æ­¥éª¤

### 1. å‡çº§åˆ°V3åç«‹å³æµ‹è¯•

```bash
# å‡çº§åˆçº¦
npx hardhat run scripts/upgrade-to-v3.js --network mainnet

# å‡çº§å®Œæˆåï¼Œæ‰“å¼€admin.html
# è¿æ¥é’±åŒ…ï¼ˆä½¿ç”¨Ownerè´¦æˆ·ï¼‰
```

### 2. åŸºç¡€è¯»å–æµ‹è¯•

åœ¨admin.htmlçš„T-Engineå¡ç‰‡ä¸­ï¼Œæ£€æŸ¥ä»¥ä¸‹å­—æ®µæ˜¯å¦æ­£å¸¸æ˜¾ç¤ºï¼š
- å½“å‰å€æ•°
- å½“å‰æ¯æ—¥é‡Šæ”¾
- é‡Šæ”¾å‘¨æœŸæ—¶é•¿
- å½“å‰Epoch
- æš‚åœçŠ¶æ€
- ç¨è´¹
- çŸ¿æ± ä½™é¢
- ç´¯è®¡é”€æ¯
- ç´¯è®¡é¢†å–

### 3. ç®¡ç†åŠŸèƒ½æµ‹è¯•

å°è¯•æ‰§è¡Œä»¥ä¸‹Owneræ“ä½œï¼ˆå»ºè®®å…ˆåœ¨æµ‹è¯•ç½‘æµ‹è¯•ï¼‰ï¼š
1. ä¿®æ”¹ä»½é¢å€æ•°ï¼ˆå¦‚ä»4æ”¹ä¸º5ï¼‰
2. ä¿®æ”¹æ¯æ—¥é‡Šæ”¾ç‡
3. åˆ‡æ¢æš‚åœçŠ¶æ€
4. ä¿®æ”¹ç¨ç‡
5. è°ƒç”¨"å¼ºåˆ¶æå‰é‡Šæ”¾ä¸€å¤©é‡"

### 4. éªŒè¯V3æ ¸å¿ƒæœºåˆ¶

åœ¨å‰ç«¯ç”¨æˆ·é¡µé¢æµ‹è¯•ï¼š
1. Aliceè´¨æŠ¼1000 DPï¼ˆæ— é‚€è¯·äººï¼‰
2. Bobè´¨æŠ¼100 DPï¼ˆAliceé‚€è¯·ï¼‰
3. åœ¨åŒºå—é“¾æµè§ˆå™¨æŸ¥çœ‹Aliceçš„totalSharesæ˜¯å¦å‡å°‘
4. æŸ¥çœ‹Bobçš„totalSharesæ˜¯å¦å¢åŠ ï¼ˆåŸºç¡€+å¥–åŠ±ï¼‰
5. æŸ¥çœ‹äº‹ä»¶`InviteRewardTransferred`

---

## âœ… ç»“è®º

**TEngineV3ä¸admin.htmlå®Œå…¨å…¼å®¹**ï¼Œå‡çº§åï¼š

1. âœ… **æ‰€æœ‰Ownerç®¡ç†åŠŸèƒ½æ­£å¸¸** - æ— éœ€ä¿®æ”¹admin.html
2. âœ… **æ‰€æœ‰è¯»å–åŠŸèƒ½æ­£å¸¸** - å¯èƒ½æœ‰2ä¸ªéå…³é”®å­—æ®µå¼‚å¸¸ï¼ˆå¯é€šè¿‡æ·»åŠ å…¼å®¹æ–¹æ³•è§£å†³ï¼‰
3. âœ… **V3æ ¸å¿ƒæœºåˆ¶ç”Ÿæ•ˆ** - é‚€è¯·å¥–åŠ±ä»ä»½é¢è½¬ç§»
4. ğŸ”„ **å¯é€‰å‡çº§** - æ·»åŠ V3æ–°å¢çš„é‚€è¯·ç»Ÿè®¡æŸ¥è¯¢åŠŸèƒ½

### å»ºè®®è¡ŒåŠ¨

1. **æœ€å°åŒ–å‡çº§**ï¼ˆæ— éœ€æ”¹å‰ç«¯ï¼‰ï¼š
   - åœ¨TEngineV3ä¸­æ·»åŠ 2ä¸ªå…¼å®¹æ–¹æ³•
   - å‡çº§åˆçº¦åç›´æ¥ä½¿ç”¨ç°æœ‰admin.html
   
2. **å®Œæ•´å‡çº§**ï¼ˆå¯é€‰ï¼‰ï¼š
   - å‡çº§åˆçº¦
   - æ›´æ–°admin.htmlï¼Œæ·»åŠ V3é‚€è¯·ç»Ÿè®¡å¡ç‰‡
   - å±•ç¤ºç´¯è®¡é‚€è¯·ä»½é¢è½¬ç§»æ•°æ®

---

**çŠ¶æ€**: âœ… éªŒè¯å®Œæˆï¼Œå…¼å®¹æ€§è‰¯å¥½
